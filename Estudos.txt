# Introdu√ß√£o a SQL com Firebird

<aside>
üìö Primeiros passos

</aside>

1 - O que o ISQL faz?

Conecta automaticamente ao banco de dados e podemos estar fazendo comandos

2 - Para que serve um banco de dados?

Serve para armazenar todos os dados de um sistema

3 - O que √© MVC e o que tem a ver com SQL?

MVC √© Movie View e Controller. 

- View √© aonde o usu√°rio ir√° visualizar, √© o HTML, CSS, Telas, VCL do Delphi
- Controller √© a regra de neg√≥cios do sistema
- Model √© representa√ß√£o de classes do banco de dados, s√£o as tabelas

<aside>
üìö Modelagem e Primeiras Opera√ß√µes

</aside>

1 - Como fazer um coment√°rio no SQL?

H√° o `/* */` para m√∫ltiplas linhas e tamb√©m o `‚Äî` para linhas √∫nicas

2 - O que √© Modelagem Conceitual?

√â um rascunho do banco de dados

```sql
	CLIENTE
		NOME 	 VARCHAR(30),
		CPF      VARCHAR(11),
		EMAIL    VARCHAR(100),
		TELEFONE VARCHAR(30),
		SEXO 	 CHAR(1),
		ENDERECO VARCHAR(100)
```

3 - O que √© Modelagem L√≥gica?

√â o software

4 - O que √© modelagem f√≠sica?

√â o script do banco de dados

5 - Como criamos um banco de dados no FB?

Abrimos o ISQL e digitamos `CREATE DATABASE '<Ditetorio>\NomeDoArquivo.FDB' user 'SYSDBA' password 'masterkey'`

6 - Como acessamos um banco de dados no FB?

Abrimos o ISQL e digitamos `connect '<Diretorio>' user 'SYSDBA' password 'masterkey'`

7 - Como fazemos para criar uma tabela?

Nos colocamos no ISQL a cria√ß√£o da tabela

```sql
CREATE TABLE CLIENTE(
NOME 	 VARCHAR(30),
CPF      VARCHAR(11),
EMAIL    VARCHAR(100),
TELEFONE VARCHAR(30),
SEXO 	 CHAR   (1),
ENDERECO VARCHAR(100));
```

8 - Como fazemos para ver se a tabela foi criada?

Vamos no ISQL e digitamos `show tables;`

9 - Como colocamos dados na tabela?

Utilizamos as combina√ß√µes `INSERT INTO` e `VALUES`

```sql
INSERT INTO CLIENTE(NOME, CPF, EMAIL, TELEFONE, SEXO, ENDERECO) VALUES ('EMANUEL', '12345678910', 'e@e.com', '+99 99 9 9999-9999', 'M', 'RUA TAL DO BAIRRO TAL E CIDADE TAL');
```

OU

```sql
INSERT INTO CLIENTE VALUES ('EMANUEL', '12345678910', 'e@e.com', '+99 99 9 9999-9999', 'M', 'RUA TAL DO BAIRRO TAL E CIDADE TAL');
```

‚ÄòPodemos‚Äô adicionar metade tamb√©m

```sql
INSERT INTO CLIENTE (NOME, CPF, SEXO) VALUES ('HALANA', '12345678910', 'F');
```

10 - Quais s√£o os tipos de dados?

- CHAR: Vai ocupar a quantidade de caracteres que voc√™ colocar, n√£o importa a quantidade setada e quantidade escrita;
- VARCHAR: N√£o ocupa todo o espa√ßo caso sobre

11 - Como podemos ver as colunas que temos na nossa tabela?

Digitamos `show table <nomeDaTabela>;`

12 - Como fazemos para puxar os dados do banco de dados?

Utilizamos o `SELECT` por exemplo: `SELECT * FROM CLIENTE;` podemos utilizar tamb√©m `SELECT nome, cpf FROM CLIENTE;`

13 - Como podemos mudar o nome da tabela?

Podemos utilizar o `AS` para ele ser visto de forma diferente, veja:

```sql
SELECT nome as name, telefone as phone, cpf as register FROM cliente;
```

14 - Como podemos filtrar o nossos campos?

Para filtrarmos n√≥s utilizamos o `WHERE` que significa ‚Äòaonde‚Äô, podemos utilizar o `LIKE` para dizer se aquela palavra est√° em algum lugar de um endere√ßo por exemplo, e utilizamos `%` se ele estiver assim `%botafogo` queremos dizer que ela √© a √∫ltima palavra, se for assim `botafogo%` dizemos que ela √© a primeira palavra e se for assim `%botafogo%` dizemos que antes e depois dela tem alguma coisa, veja os exemplos:

```sql
SELECT NOME, SEXO FROM CLIENTE WHERE SEXO = 'M';
```

H√° tamb√©m:

```sql
SELECT NOME, ENDERECO FROM CLIENTE WHERE ENDERECO LIKE '%BAIRRO%';
```

15 - Quais s√£o os os operadores l√≥gicos?

S√£o: AND; OR; IS NOT, veja:

```sql
SELECT nome from cliente where telefone is not null;
SELECT nome, cpf from cliente where cpf is not null and sexo = 'F';
```

16 - Como podemos saber quantos registros tem na tabela?

Utilizamos o `COUNT` e passamos o que queremos

```sql
// RETORNAR QUANTIDADE DE LINHAS
SELECT COUNT(*) FROM CLIENTE;

// MUDA O NOME DO COUNT
SELECT COUNT(*) AS "QUANTIDADE DE LINHAS NA TABELA" FROM CLIENTE;
```

17 - Como devemos usar o GROUP BY?

Utilizamos ele juntamente com o `COUNT`. Se usarmos apenas o COUNT ele vai contar todas as linhas, com o GROUP BY conseguimos diferenciar

```sql
-- VAI SELECIONAR TODOS OS SEXOS E RETORNAR ELES SEPARADOS
SELECT SEXO, COUNT(*) AS "QUANTIDADE" FROM CLIENTE GROUP BY SEXO;
```

18 - COMO PODEMOS FILTRAR ALGO NULO?

```sql
-- PARA FILTRAR ALGO QUE √â NULO USAMOS O IS NULL
SELECT NOME, ENDERECO FROM CLIENTE WHERE ENDERECO IS NULL;

-- PARA FILTRAR ALGO QUE N√ÉO √â NULO
SELECT NOME, ENDERECO FROM CLIENTE WHERE ENDERECO IS NOT NULL;
```

19 - Como podemos alterar o dados de forma segura?

Utilizamos o `UPDATE` e `WHERE` pois se n√£o colocarmos ele vai atualizar todos os dados;

```sql
UPDATE CLIENTE SET CPF = '12345678910' WHERE NOME = 'JOAO';
```

20 - Como podemos deletar dados de forma segura?

Utilizamos o `DELETE` com o `WHERE` para n√£o termos problema

```sql
DELETE FROM CLIENTE WHERE NOME = 'EMANUEL';
```

21 - O que √© cardinalidade?

O que define a cardinalidade √© a regra de neg√≥cio 

O 1¬™ algarismo fala sobre a obrigatoriedade

- 0 √© n√£o √© obrigat√≥rio;
- 1 √© obrigat√≥rio;

O 2¬∫ algarismo fala sobre a cardinalidade

- 1 aceita apenas um registro
- n aceita v√°rios registros

22 - Como podemos criar uma coluna √∫nica?

Utilizamos o `UNIQUE`: `CPF VARCHAR(15) UNIQUE;`

23 - Como podemos criar uma primary key no Firebird?

```sql
/*
	ALTER TABLE CLIENTE: Vai fazer ma altera√ß√£o na tabela cliente
	CONSTRAINT PKIDCLIENTE: Alterando para colocar uma CONSTRAINT e damos um nome para ela
	PRIMARY KEY(IDCLIENTE): Fala qual coluna da nossa tabela vai ser a chave prim√°ria
*/
ALTER TABLE CLIENTE CONSTRAINT PKIDCLIENTE PRIMARY KEY(IDCLIENTE);
```

24 - Como definimos a chave estrangeira?

Chave estrangeira √© uma chave prim√°ria de outra tabela que faz refer√™ncia, com isso n√≥s podemos interligar tabelas

- Em 1x1 a chave estrangeira fica na tabela mais fraca;
- Em 1xn a chave estrangeira fica na tabela N

---

```sql
-- CRIANDO O BANCO DE DADOS
CREATE DATABASE 'C:\BD\EXERCICIO.FDB' USER 'SYSDBA' PASSWORD 'MASTERKEY';

-- CONECTANDO NO BANCO DE DADOS
CONNECT 'C:\BD\EXERCICIO.FDB' USER 'SYSDBA' PASSWORD 'MASTERKEY';

-- CRIANDO TABELA CLIENTE
CREATE TABLE CLIENTE(
	IDCLIENTE INTEGER     NOT NULL,
	NOME      VARCHAR(30) NOT NULL
);

/*
	CRIANDO UMA SEQU√äNCIA ANTES DE CRIAR UMA CHAVE PRIM√ÅRIA
	ELE VAI CONTROLAR OS NOSSOS REGISTROS, PODEMOS CONTROLAR A PARTIR DE QUE REGISTRO ELE VAI COME√áAR A FUNCIONAR
	PARA O AUTO INCREMENTO FUNCIONAR N√ìS DEVEMOS CRIAR UMA TRIGGER QUE √â UM COMANDO QUE EXECUTA UM BLOCO DE C√ìDIGO QUANDO NOSSO BANCO DE DADOS √â ALTERADO
*/
CREATE SEQUENCE ID_CLIENTE;
-- CRIANDO UMA CHAVE PRIM√ÅRIA
ALTER TABLE CLIENTE ADD CONSTRAINT PKIDCLIENTE PRIMARY KEY(IDCLIENTE);
-- TRIGGER PARA CONTROLAR OS ID
/*
	CREATE TRIGGER TG_INSERTCLIENTE FOR CLIENTE BEFORE INSERT POSITION 0
	CREATE TRIGGER TG_INSERTCLIENTE: CRIAR UMA TRIGGER E ATRIBUIR UM NOME A ELA
	FOR CLIENTE: FALAMOS PARA QUAL TABELA ESSA TRIGGER IR√Å FUNCIONAR
	BEFORE INSERT POSITION 0: INSERIR A PARTIR DA POSI√á√ÉO 0
*/
CREATE TRIGGER TG_INSERTCLIENTE FOR CLIENTE BEFORE INSERT POSITION 0
AS
BEGIN
	/*
		NEW.IDCLIENTE: VAI CRIAR UM NOVO IDCLIENTE QUE VAI RECEBER UM GEN_ID
		GEN_ID('ID_CLIENTE', 1): GEN_ID √â UM INCREMENTO, VAI PEGAR O NOME DA SEQUENCIA QUE
			CRIAMOS 'ID_CLIENTE' E VAI INCREMENTAR COM O VALOR QUE PEGARMOS '1'
	*/
	NEW.IDCLIENTE = GEN_ID(ID_CLIENTE, 1);
END;

-- CRIANDO TABELA TELEFONE
CREATE TABLE TELEFONE(
	IDTELEFONE INTEGER NOT NULL,
	NUMERO     INTEGER,
	ID_CLIENTE INTEGER NOT NULL
);

CREATE SEQUENCE ID_TELEFONE;
ALTER TABLE TELEFONE ADD CONSTRAINT PKIDTELEFONE PRIMARY KEY(IDTELEFONE);
ALTER TABLE TELEFONE ADD CONSTRAINT FKID_CLIENTE_TELEFONE FOREING KEY(ID_CLIENTE) REFERENCES(CLIENTE);
CREATE TRIGGER TG_INSERTTELEFONE FOR TELEFONE BEFORE INSERT POSITION 0
AS
BEGIN
	NEW.IDTELEFONE = GEN_ID(ID_TELEFONE, 1);
END;

-- CRIANDO TABELA CARRO
CREATE TABLE CARRO(
	IDCARRO INTEGER NOT NULL,
	NOME    VARCHAR(30) NOT NULL,
	MARCA   VARCHAR(30) NOT NULL,
	ID_CLIENTE INTEGER NOT NULL
);

CREATE SEQUENCE ID_CARRO;
ALTER TABLE CARRO ADD CONSTRAINT PKIDCARRO PRIMARY KEY(IDCARRO);
ALTER TABLE CARRO ADD CONSTRAINT FKID_CLIENTE_CARRO FOREING KEY(ID_CLIENTE) REFERENCES(CLIENTE);
CREATE TRIGGER TG_INSERTCARRO FOR CARRO BEFORE INSERT POSITION 0
AS
BEGIN
	NEW.IDCARRO = GEN_ID(ID_CARRO, 1);
END;
```

25 - O que √© Query?

Query √© uma consulta SQL

26 - Como fazemos uma chave prim√°ria?